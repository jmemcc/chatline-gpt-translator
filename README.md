# LINE GPT Translator

LINE GPT Translator is a Python app that translates messages in LINE from Japanese to English (and vice-versa) using the GPT-3 Turbo API.

>  [このドキュメントの日本語版はこちらでご覧いただけます](https://github.com/jmemcc/line-gpt-translator/blob/master/docs/jp/README_jp.md)

## Requirements

- Python >= 3.8
- line-bot-sdk >= 3.7.0
- Flask >= 3.0.0
- Gunicorn >= 21.2.0

## Installation

Pull the repository from GitHub.

```bash
gh repo clone jmemcc/line-gpt-translator
```

## Setup 

Create an [OpenAI API key](https://platform.openai.com/api-keys), and a [LINE Developer account](https://developers.line.biz/). In your LINE Developer console, create a channel with [Messaging API](https://developers.line.biz/en/services/messaging-api/) type. 

### Local/VPS Server

Export variables below to your server.

```bash
# found in OpenAI developer section (https://platform.openai.com/api-keys)
export OPENAI_API_KEY=YOUR_KEY_HERE

# found in LINE Developer page for your bot's channel under 'Messaging API' tab (https://developers.line.biz/console/channel/YOUR_CHANNEL_ID/messaging-api)
export LINE_CHANNEL_SECRET=YOUR_KEY_HERE
export LINE_CHANNEL_ACCESS_TOKEN=YOUR_KEY_HERE
```

LINE requires Messaging API channels to use an internet connected server. Use your hosting method of choice, below [ngrok](https://ngrok.com/) is used as an example.

```bash
ngrok http 8000
```

Navigate to the Messaging API tab and set the **Webhook URL** to the URL generated by ngrok with `/callback` appended (e.g. `https://xxxx-xxx-xxx-xx-xx.ngrok-free.app/callback`), toggle on **Use webhook**, and click **Verify**. You should get a message saying 'Success'. 

Set the **LINE Official Account features** however you wish.

### Vercel

Fork this repository to your GitHub and create a new Vercel project from the fork. 

In the **Configure Project** section, leave everything the same, but add your `OPENAI_API_KEY`, `LINE_CHANNEL_SECRET`, and `LINE_CHANNEL_ACCESS_TOKEN` as **Environment Variables**.

Deploy the project, then once the deployment is complete: 
- Copy the URL under **Domains**
- Navigate to the Messaging API tab in the LINE channel page,
- Paste the URL into the **Webhook URL** and append `/callback` to the string (e.g. `https://xxxxxxxxx.vercel.app/callback`)
- Toggle on **Use webhook**, and click **Verify**. If you should get a message saying 'Success', the bot is able to connect to the server.
- Disable the **Auto-reply messages** option under **LINE Official Account features**, and enable **Allow bot to join group chats**.

## Usage

Start the app with internet connected server running.

```bash
# run with 4 processes to manage multiple messages
gunicorn -w 4 -b 0.0.0.0:8000 app:app

# or run using just 1 process using Flask
python app.py
```

Message your bot on LINE with some text to translate.

## License

[Apache License 2.0](https://choosealicense.com/licenses/apache-2.0/)
